---
interface props {
  numero: number;
  pregunta: string;
  respuesta: string;
}

const { numero, pregunta, respuesta } = Astro.props;
---

<div class="flip-card text-white">
  <div class="flip-card-inner noActive">
    <div class="flip-card-front bg-morado-texto">
      <p class="text-12xl font-bold">{numero}</p>
      <p>Click</p>
    </div>
    <div class="flip-card-back">
      <p class="title">{pregunta}</p>
      <div class="mt-6 flex gap-4 items-center justify-center" data-number={numero}>
        <button class="py-2 px-4 bg-white rounded-3xl text-morado-texto font-bold flex-1 text-center" data-res="verdadero">VERDADERO</button>
        <button class="py-2 px-4 bg-rosado rounded-3xl text-white font-bold flex-1 text-center" data-res="falso">FALSO</button>
      </div>
    </div>
  </div>
</div>

<style is:global>
  .flip-card {
    background-color: transparent;
    width: 450px;
    height: 450px;
    perspective: 2000px;
    font-family: sans-serif;
  }

  .title {
    font-size: 1.4em;
    font-weight: 700;
    text-align: center;
    margin: 0;
  }


  .flip-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 0.8s;
    transform-style: preserve-3d;
  }


  .flip-card-front,
  .flip-card-back {
    box-shadow: 0 8px 14px 0 rgba(0, 0, 0, 0.2);
    position: absolute;
    display: flex;
    flex-direction: column;
    justify-content: center;
    width: 100%;
    height: 100%;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    border-radius: 1rem;
    padding: 25px;
  }

  .active{
    transform: rotateY(-180deg);
  }

  .flip-card:hover .noActive{
    transform: rotateY(-10deg);
  }

  .flip-card-back {
    background: #772583;
    color: white;
    transform: rotateY(-180deg);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // obtener la data de public/data.json
    fetch('/public/data/data.json')
      .then(response => response.json())
      .then(json => {
        data = json;
    });
    
    const flipCards = document.querySelectorAll('.flip-card');
    let ultimeFlipCard = null;

    let data = null;

    flipCards.forEach((flipCard) => {
      flipCard.addEventListener('click', (e) => {

        let el = e.target as Element;

        if (el.tagName === 'BUTTON') {
          const res = el.getAttribute('data-res');
          const number = el.parentElement.getAttribute('data-number');


          if (!res || !number || !data) return;


          const pregunta = data.find((item) => item.numero === parseInt(number));
          if (pregunta.respuesta_correcta === res) {
            alert('Correcto');
          } else {
            alert('Incorrecto');
          }
          return;
        }

        if (flipCard.querySelector('.flip-card-inner').classList.contains('active')) {
          return;
        }

        if (ultimeFlipCard) {
          ultimeFlipCard.querySelector('.flip-card-inner').classList.remove('active');
          ultimeFlipCard.querySelector('.flip-card-inner').classList.add('noActive');
        }

        flipCard.querySelector('.flip-card-inner').classList.remove('noActive');
        flipCard.querySelector('.flip-card-inner').classList.add('active');
        ultimeFlipCard = flipCard;
      });
    });

    

  });

  

</script>
